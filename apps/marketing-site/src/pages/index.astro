---
import { Image } from "astro:assets";
import Logo from "../components/Logo.astro";
import mockupImage from "../assets/mockup.png";
import screenshotImage from "../assets/screenshot.png";
import FeatureCard from "../components/FeatureCard.astro";
import { WaitlistForm } from "../components/WaitlistForm.tsx";

import "../global.css";

let success = false;
let error: string | undefined;

if (Astro.request.method === "POST") {
  try {
    const data = await Astro.request.formData();

    const response = await fetch(
      `${import.meta.env.DEV ? "http" : "https"}://${
        import.meta.env.PUBLIC_APP_DOMAIN
      }/api/waitlist/request-approval`,
      {
        method: "POST",
        body: data,
        mode: "cors",
      }
    );

    if (!response.ok) {
      throw new Error("Bad response from Volamail server");
    }

    success = true;
  } catch (e) {
    console.log(e);

    error = "An error occurred";
  }
}

const loginLink = `${import.meta.env.DEV ? "http" : "https"}://${
  import.meta.env.PUBLIC_APP_DOMAIN
}/login`;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000" />
    <meta name="msapplication-TileColor" content="#000000" />
    <meta name="theme-color" content="#ffffff" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400..900&display=swap"
      rel="stylesheet"
    />

    <title>Simple email for everyone - Volamail</title>

    <meta
      name="description"
      content="Write emails with the help of AI and send them with an API call. E-mail shouldn't be so difficult."
    />
    <meta
      name="keywords"
      content="email, ai, api, email api, open-source, self-hostable, free, pro, enterprise, startup, small team, large team, large company, email tooling, email automation, email marketing, marketing automation, marketing software, automation software, automation tool, automation platform, automation software, automation tool, automation platform, self-hosted, hosted, cloud, serverless, web, frontend, backend, platform, software"
    />
  </head>
  <body>
    <main class="flex flex-col min-h-dvh justify-center items-center">
      <div
        class="h-dvh bg-grid-black/5 w-full relative flex flex-col justify-start"
      >
        <div
          class="absolute pointer-events-none top-0 left-0 w-full h-dvh flex items-center justify-center bg-white [mask-image:radial-gradient(ellipse_at_center,transparent_20%,white)]"
        >
        </div>

        <section
          class="max-w-5xl mx-auto w-full flex justify-between items-center p-8 relative h-[90dvh]"
        >
          <div class="flex flex-col gap-4 max-w-md">
            <h1 class="text-5xl font-black text-left">
              Simple email
              <br /> for everyone
            </h1>
            <p class="text-left text-gray-700">
              Write email templates with the help of AI and send them with an
              API call. E-mail shouldn't be so difficult.
            </p>

            <div class="flex items-center gap-6 mt-8 max-w-sm w-full z-10">
              <WaitlistForm client:load error={error} success={success} />
            </div>
          </div>
          <Image
            src={mockupImage}
            sizes="400px"
            class="md:opacity-100 opacity-20 w-96 absolute top-1/2 -translate-y-1/2 right-0 pointer-events-none"
            alt=""
          />
        </section>
      </div>
      <div class="relative mb-16 -mt-32 px-8">
        <Image
          src={screenshotImage}
          class="w-full max-w-4xl rounded-xl aspect-[14/9]"
          alt=""
          sizes="(max-width: 768px) 768px, 1280px"
        />
        <div
          class="absolute inset-0 bg-gradient-to-b from-transparent to-white z-50"
        >
        </div>
      </div>
      <section class="flex flex-col gap-4 max-w-5xl w-full px-8 z-10">
        <h2 class="text-3xl font-bold">Features</h2>
        <div class="flex flex-col sm:grid grid-cols-2 grid-rows-2 gap-4">
          <FeatureCard title="AI-assisted editing">
            You can write and compose email templates with the help of AI
            prompts. You can also select a single element to edit and prompt the
            AI to make changes to it.
          </FeatureCard>
          <FeatureCard title="Importing emails">
            The AI-based editor works with plain HTML, so you can gradually try
            out the platform by import your existing emails.
          </FeatureCard>
          <FeatureCard title="Self-hosting">
            Volamail is 100% open source and self-hostable. There are very few
            moving parts so you can easily deploy it to your own infrastructure.
          </FeatureCard>
          <FeatureCard title="Marketing and transactional">
            Editing teams will be able to lay out marketing emails and send them
            to an audience straight from the dashboard. Transactional emails can
            be sent by developers via a simple fetch call.
          </FeatureCard>
        </div>
      </section>

      <section class="flex flex-col gap-4 max-w-5xl w-full px-8 py-32">
        <h2 class="text-3xl font-bold">Pricing</h2>
        <p class="text-gray-600">
          Simple, predictable pricing that scales with your needs.
        </p>

        <div class="flex flex-col gap-4">
          <div
            class="border border-gray-300 bg-gray-50 rounded-lg p-4 flex flex-col gap-1"
          >
            <h3 class="font-semibold text-xl">Self-hosted</h3>
            <p class="text-gray-600 text-sm">
              Pay nothing and get access to all features, forever. Hosting
              Volamail on your own cloud is meant to be easy.
            </p>
          </div>
          <div class="flex items-center gap-2">
            <hr class="grow" />
            <span class="text-gray-400 text-xs">Or try our hosted plans</span>
            <hr class="grow" />
          </div>
          <div class="flex flex-col md:flex-row gap-2">
            <div
              class="border flex-1 border-gray-300 bg-gray-50 rounded-lg p-4 flex flex-col gap-4"
            >
              <div class="flex flex-col gap-4 grow">
                <div class="flex flex-col gap-1">
                  <h3 class="font-semibold text-xl">Free</h3>
                  <p class="font-bold text-2xl">
                    $0<span class="text-sm">/month</span>
                  </p>
                </div>
                <p class="text-gray-600 text-sm">
                  Our free hosted plan, suited for small projects and people
                  that just want to try the platform.
                </p>

                <p class="text-gray-600 text-sm">
                  You'll be able to try most features in Volamail with a 500
                  emails per month quota.
                </p>

                <ul
                  class="grow justify-end text-sm list-disc pl-3 gap-1 text-gray-600 flex flex-col"
                >
                  <li>Base AI model</li>
                  <li>500 emails/month</li>
                  <li>Unlimited AI generations and edits</li>
                  <li>2 projects</li>
                  <li>20MB image storage per project</li>
                </ul>
              </div>

              <a
                href={loginLink}
                class="bg-transparent text-center hover:bg-gray-200 transition-colors text-black border-black border px-4 py-2 rounded-lg text-sm font-medium"
              >
                Get started
              </a>
            </div>

            <div
              class="border flex-1 border-black bg-gray-50 rounded-lg p-4 flex flex-col gap-4"
            >
              <div class="flex flex-col gap-4 grow">
                <div class="flex flex-col gap-1">
                  <h3 class="font-semibold text-xl">Pro</h3>
                  <p class="font-bold text-2xl">
                    $19<span class="text-sm">/month</span>
                  </p>
                </div>
                <p class="text-gray-600 text-sm">
                  Our main plan, suited for startups, small teams or large solo
                  projects.
                </p>

                <p class="text-gray-600 text-sm">
                  You'll get access to every feature in Volamail, a better AI
                  model and a higher monthly email quota.
                </p>

                <ul
                  class="grow justify-end text-sm list-disc pl-3 gap-1 text-gray-600 flex flex-col"
                >
                  <li>Better AI model</li>
                  <li>10000 emails/month</li>
                  <li>Unlimited AI generations and edits</li>
                  <li>5 projects</li>
                  <li>50MB image storage per project</li>
                </ul>
              </div>

              <a
                href={loginLink}
                class="bg-black text-center hover:bg-gray-700 transition-colors text-white px-4 py-2 rounded-lg text-sm font-medium"
              >
                Get started
              </a>
            </div>
            <div
              class="border flex-1 border-gray-300 bg-gray-50 rounded-lg p-4 flex flex-col gap-2"
            >
              <div class="flex flex-col gap-2 grow">
                <h3 class="font-semibold text-xl">Custom plans</h3>

                <p class="text-gray-600 text-sm">
                  We offer custom plans for larger teams or companies that need
                  higher quotas or different feature-sets.
                </p>
                <p class="text-gray-600 text-sm">
                  Don't hesitate to reach out even if you're a smaller company,
                  our plans are affordable and we'll work with you to find the
                  best fit.
                </p>
              </div>

              <a
                href="mailto:info@volamail.com"
                class="border-black border hover:bg-gray-200 transition-colors bg-transparent text-center px-4 py-2 rounded-lg text-sm font-medium"
              >
                Contact us
              </a>
            </div>
          </div>
        </div>
      </section>

      <footer
        class="w-full border-t max-w-5xl mx-auto justify-between border-gray-100 p-8 flex items-center"
      >
        <Logo class="w-6" />
        <div class="flex gap-6 items-center text-sm">
          <a
            href="https://docs.volamail.com"
            target="_blank"
            class="text-gray-500 hover:text-black transition-colors"
          >
            Docs
          </a>
          <a
            href="https://github.com/volamail/volamail"
            target="_blank"
            class="text-gray-500 hover:text-black transition-colors"
          >
            GitHub
          </a>
          <a
            href="https://x.com/volamail"
            target="_blank"
            class="text-gray-500 hover:text-black transition-colors"
          >
            X
          </a>
        </div>
      </footer>
    </main>
  </body>
</html>
